{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adlan/multas/multas/app/api/usuarios/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { Pool } from \"pg\";\r\nimport bcrypt from \"bcryptjs\";\r\n\r\nconst pool = new Pool({\r\n  connectionString: process.env.DATABASE_URL,\r\n});\r\n\r\n// GET → Obtener todos los usuarios\r\nexport async function GET() {\r\n  try {\r\n    const res = await pool.query(\r\n      \"SELECT id, username, role FROM users ORDER BY id ASC\"\r\n    );\r\n    return NextResponse.json(res.rows);\r\n  } catch (err: any) {\r\n    return NextResponse.json({ error: err.message }, { status: 500 });\r\n  }\r\n}\r\n\r\n// POST → Crear usuario nuevo\r\nexport async function POST(req: Request) {\r\n  try {\r\n    const { username, password, role } = await req.json();\r\n\r\n    if (!username || !password || !role) {\r\n      return NextResponse.json({ error: \"Faltan campos\" }, { status: 400 });\r\n    }\r\n\r\n    const hashed = await bcrypt.hash(password, 10);\r\n\r\n    const query = `\r\n      INSERT INTO users (username, password, role)\r\n      VALUES ($1, $2, $3)\r\n      RETURNING id, username, role;\r\n    `;\r\n\r\n    const result = await pool.query(query, [username, hashed, role]);\r\n\r\n    return NextResponse.json(result.rows[0]);\r\n  } catch (err: any) {\r\n    return NextResponse.json({ error: err.message }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;AAC5C;AAGO,eAAe;IACpB,IAAI;QACF,MAAM,MAAM,MAAM,KAAK,KAAK,CAC1B;QAEF,OAAO,oKAAY,CAAC,IAAI,CAAC,IAAI,IAAI;IACnC,EAAE,OAAO,KAAU;QACjB,OAAO,oKAAY,CAAC,IAAI,CAAC;YAAE,OAAO,IAAI,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACjE;AACF;AAGO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,IAAI;QAEnD,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,MAAM;YACnC,OAAO,oKAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAgB,GAAG;gBAAE,QAAQ;YAAI;QACrE;QAEA,MAAM,SAAS,MAAM,kKAAM,CAAC,IAAI,CAAC,UAAU;QAE3C,MAAM,QAAQ,CAAC;;;;IAIf,CAAC;QAED,MAAM,SAAS,MAAM,KAAK,KAAK,CAAC,OAAO;YAAC;YAAU;YAAQ;SAAK;QAE/D,OAAO,oKAAY,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,EAAE;IACzC,EAAE,OAAO,KAAU;QACjB,OAAO,oKAAY,CAAC,IAAI,CAAC;YAAE,OAAO,IAAI,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACjE;AACF"}}]
}