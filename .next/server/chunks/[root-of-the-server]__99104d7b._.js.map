{"version":3,"sources":["../../../../../multas/multas/lib/db.ts"],"sourcesContent":["import {\r\n  Pool,\r\n  PoolClient,\r\n  QueryResult,\r\n  QueryResultRow,\r\n} from \"pg\";\r\n\r\ndeclare global {\r\n  // eslint-disable-next-line no-var\r\n  var pgPool: Pool | undefined;\r\n}\r\n\r\nconst pool =\r\n  global.pgPool ??\r\n  new Pool({\r\n    connectionString: process.env.DATABASE_URL,\r\n    ssl: { rejectUnauthorized: false },\r\n    max: 5,\r\n  });\r\n\r\nif (process.env.NODE_ENV !== \"production\") {\r\n  global.pgPool = pool;\r\n}\r\n\r\nexport const query = <T extends QueryResultRow = any>(\r\n  text: string,\r\n  params?: any[]\r\n): Promise<QueryResult<T>> => {\r\n  return pool.query(text, params);\r\n};\r\n\r\nexport const getClient = (): Promise<PoolClient> => {\r\n  return pool.connect();\r\n};\r\n\r\nexport const poolInstance = pool;\r\n"],"names":[],"mappings":"m0CAAA,IAAA,EAAA,EAAA,CAAA,CAAA,yCAYA,IAAM,EACJ,OAAO,MAAM,EACb,IAAI,EAAA,IAAI,CAAC,CACP,iBAAkB,QAAQ,GAAG,CAAC,YAAY,CAC1C,IAAK,CAAE,oBAAoB,CAAM,EACjC,IAAK,CACP,kBAMmB,CACnB,EACA,IAEO,EAAK,KAAK,CAAC,EAAM"}