module.exports=[81927,(a,b,c)=>{"use strict";b.exports=a.r(95696).vendored.contexts.HooksClientContext},75384,(a,b,c)=>{"use strict";b.exports=a.r(95696).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},95696,(a,b,c)=>{"use strict";b.exports=a.r(18622)},24183,(a,b,c)=>{"use strict";b.exports=a.r(95696).vendored["react-ssr"].ReactJsxRuntime},34041,(a,b,c)=>{"use strict";b.exports=a.r(95696).vendored["react-ssr"].React},89117,(a,b,c)=>{"use strict";b.exports=a.r(95696).vendored.contexts.AppRouterContext},73934,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},43030,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DEFAULT_SEGMENT_KEY:function(){return l},PAGE_SEGMENT_KEY:function(){return k},addSearchParamsIfPageSegment:function(){return i},computeSelectedLayoutSegment:function(){return j},getSegmentValue:function(){return f},getSelectedLayoutSegmentPath:function(){return function a(b,c,d=!0,e=[]){let g;if(d)g=b[1][c];else{let a=b[1];g=a.children??Object.values(a)[0]}if(!g)return e;let h=f(g[0]);return!h||h.startsWith(k)?e:(e.push(h),a(g,c,!1,e))}},isGroupSegment:function(){return g},isParallelRouteSegment:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return Array.isArray(a)?a[1]:a}function g(a){return"("===a[0]&&a.endsWith(")")}function h(a){return a.startsWith("@")&&"@children"!==a}function i(a,b){if(a.includes(k)){let a=JSON.stringify(b);return"{}"!==a?k+"?"+a:k}return a}function j(a,b){if(!a||0===a.length)return null;let c="children"===b?a[0]:a[a.length-1];return c===l?null:c}let k="__PAGE__",l="__DEFAULT__"},75854,(a,b,c)=>{"use strict";function d(){let a,b,c=new Promise((c,d)=>{a=c,b=d});return{resolve:a,reject:b,promise:c}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createPromiseWithResolvers",{enumerable:!0,get:function(){return d}})},78886,a=>{"use strict";var b=a.i(24183),c=a.i(34041),d=a.i(65128);function e({data:a={}}){let e=a=>/^#([0-9A-Fa-f]{6})$/.test(String(a||"")),f=(0,d.useParams)(),g=f?.id?String(f.id):null,h=a.plantilla_pago_id??a.plantillas_pago_id??a.plantilla_id??a.id_plantilla??a.plantillaPagoId??a.plantillaId??a.id??null,i=g??(h?String(h):null),[j,k]=(0,c.useState)(null),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)("");(0,c.useEffect)(()=>{let a=!1;return async function(){m(!0),o("");try{let b=i?`/api/plantillas/${encodeURIComponent(i)}`:"/api/plantilla-pago",c=await fetch(b,{cache:"no-store"}),d=await c.json().catch(()=>({}));if(!c.ok)throw Error(d?.error||"No se pudo cargar la plantilla");let e=d?.data??d;a||k(e)}catch(b){console.error("❌ Error cargando plantilla:",b),a||(k(null),o(b?.message||"Error cargando plantilla"))}finally{a||m(!1)}}(),()=>{a=!0}},[i]);let p=(0,c.useMemo)(()=>((a={},b={})=>{let c={...a};for(let[a,d]of Object.entries(b||{}))null!=d&&""!==d&&(c[a]=d);return c})(j??{},a??{}),[j,a]),q=p?.subproducto??p?.ubproducto??"",r=p?.cuenta_bancaria??"",s=p?.url??p?.logo_url??p?.imagen_url??p?.logoUrl??p?.logo??null,t=(0,c.useMemo)(()=>(a=>{if(!a)return null;let b=String(a).trim().replaceAll("\\","/");return/^https?:\/\//i.test(b)||(b.startsWith("public/uploads/")&&(b=b.replace("public/","")),b.startsWith("uploads/")&&(b=`/${b}`),b.startsWith("/")),b})(s),[s]),u=!!q&&!!r&&!!s,[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(0);(0,c.useEffect)(()=>{p?.monto!=null&&""===B&&C(String(p.monto)),p?.importe_pagar!=null&&""===D&&E(String(p.importe_pagar)),p?.fecha_vencimiento&&!F&&G(String(p.fecha_vencimiento)),"number"==typeof p?.dias_vencidos&&I(p.dias_vencidos),p?.nombre_cliente&&!v&&w(String(p.nombre_cliente)),p?.telefono_cliente&&!x&&y(String(p.telefono_cliente)),"boolean"==typeof p?.mostrar_extras&&A(p.mostrar_extras)},[p]),(0,c.useEffect)(()=>{E(B)},[B]),(0,c.useEffect)(()=>{if(!F)return I(0);let a=new Date;I(Math.ceil((new Date(F+"T00:00:00").getTime()-a.getTime())/864e5))},[F]);let[J,K]=(0,c.useState)("#ffffff"),[L,M]=(0,c.useState)("#ffffff"),[N,O]=(0,c.useState)("#0F56F7"),[P,Q]=(0,c.useState)("#0F56F7"),[R,S]=(0,c.useState)(""),[T,U]=(0,c.useState)("");(0,c.useEffect)(()=>{p?.card_bg_color&&e(p.card_bg_color)&&(K(String(p.card_bg_color)),M(String(p.card_bg_color))),p?.primary_color&&e(p.primary_color)&&(O(String(p.primary_color)),Q(String(p.primary_color)))},[p?.card_bg_color,p?.primary_color]);let[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(null);async function Z(){let a={plantilla_pago_id:i,subproducto:p.subproducto??p.ubproducto,cuenta_bancaria:p.cuenta_bancaria,url:t,monto:B,importe_pagar:D,fecha_vencimiento:F||null,dias_vencidos:H,nombre_cliente:v,telefono_cliente:x,mostrar_extras:z,card_bg_color:J,primary_color:N,locked:!0},b=await fetch("/api/plantillas-temporales",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),c=await b.json().catch(()=>({}));if(!b.ok)throw Error(c?.error||"No se pudo generar el link");return String(c.link)}let $=async()=>{if(!V){W(!0);try{let a=await Z();Y(a),window.location.href=a}catch(a){alert(a?.message||"Error generando link")}finally{W(!1)}}};return!l&&(u||n)?n&&!u?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#152032] text-white p-6",children:(0,b.jsxs)("div",{className:"max-w-md",children:[(0,b.jsx)("div",{className:"text-xl font-bold mb-2",children:"No se pudo cargar la plantilla"}),(0,b.jsx)("div",{className:"text-sm opacity-90",children:n})]})}):(0,b.jsxs)("div",{className:"w-full min-h-screen flex items-center justify-center p-6 relative bg-[#152032]",children:[(0,b.jsxs)("div",{className:"absolute right-6 top-16 z-50 flex flex-col gap-4 w-60",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-white",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:"Mostrar datos del cliente"}),(0,b.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:z,onChange:()=>A(!z),className:"sr-only peer",disabled:V}),(0,b.jsx)("div",{className:"w-11 h-6 bg-gray-300 peer-checked:bg-blue-600 rounded-full relative   after:content-[''] after:w-5 after:h-5 after:bg-white after:rounded-full   after:absolute after:left-1 after:top-0.5 peer-checked:after:translate-x-5 transition-all"})]})]}),(0,b.jsxs)("div",{className:"bg-white/5 p-3 rounded-lg",children:[(0,b.jsx)("div",{className:"text-xs text-white mb-2 font-medium",children:"Fondo de la tarjeta"}),(0,b.jsx)("select",{className:"w-full p-2 rounded-md mb-2 text-sm",value:J,onChange:a=>{K(a.target.value),M(a.target.value),S("")},disabled:V,children:[{label:"Blanco",value:"#FFFFFF"},{label:"Gris claro",value:"#F8FAFC"},{label:"Gris suave",value:"#EEF2F6"},{label:"Marfil",value:"#FFF4E6"},{label:"Crema",value:"#FFF7ED"},{label:"Very Light Blue",value:"#F0F9FF"},{label:"Lavanda",value:"#F5F3FF"},{label:"Rosa claro",value:"#FFF1F2"},{label:"Verde suave",value:"#ECFDF5"},{label:"Amarillo suave",value:"#FFFBEB"},{label:"Gris perla",value:"#F1F5F9"},{label:"Humo",value:"#F3F4F6"}].map(a=>(0,b.jsxs)("option",{value:a.value,children:[a.label," — ",a.value]},a.value))}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"text",value:L,onChange:a=>{var b;M(b=a.target.value),e(b)?(K(b),S("")):S("Ingresa color en formato #RRGGBB")},className:"flex-1 p-2 rounded-md text-sm",placeholder:"#RRGGBB",disabled:V}),(0,b.jsx)("div",{className:"w-10 h-10 rounded-md border",style:{backgroundColor:e(L)?L:J}})]}),R&&(0,b.jsx)("div",{className:"text-xs text-rose-400 mt-1",children:R})]}),(0,b.jsxs)("div",{className:"bg-white/5 p-3 rounded-lg",children:[(0,b.jsx)("div",{className:"text-xs text-white mb-2 font-medium",children:"Color del botón / burbuja"}),(0,b.jsx)("select",{className:"w-full p-2 rounded-md mb-2 text-sm",value:N,onChange:a=>{O(a.target.value),Q(a.target.value),U("")},disabled:V,children:[{label:"Azul (default)",value:"#0F56F7"},{label:"Naranja",value:"#FF6B00"},{label:"Verde",value:"#10B981"},{label:"Rojo",value:"#EF4444"},{label:"Morado",value:"#7C3AED"},{label:"Teal",value:"#06B6D4"},{label:"Indigo",value:"#4F46E5"},{label:"Cian",value:"#0891B2"},{label:"Rosa fuerte",value:"#EC4899"},{label:"Amarillo",value:"#F59E0B"},{label:"Gris oscuro",value:"#374151"},{label:"Negro",value:"#111827"}].map(a=>(0,b.jsxs)("option",{value:a.value,children:[a.label," — ",a.value]},a.value))}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"text",value:P,onChange:a=>{var b;Q(b=a.target.value),e(b)?(O(b),U("")):U("Ingresa color en formato #RRGGBB")},className:"flex-1 p-2 rounded-md text-sm",placeholder:"#RRGGBB",disabled:V}),(0,b.jsx)("div",{className:"w-10 h-10 rounded-md border",style:{backgroundColor:e(P)?P:N}})]}),T&&(0,b.jsx)("div",{className:"text-xs text-rose-400 mt-1",children:T})]}),X&&(0,b.jsxs)("div",{className:"bg-white/5 p-3 rounded-lg",children:[(0,b.jsx)("div",{className:"text-xs text-white mb-2 font-medium",children:"Link generado"}),(0,b.jsx)("input",{className:"w-full p-2 rounded-md text-sm",value:X,readOnly:!0}),(0,b.jsx)("button",{className:"mt-2 w-full p-2 rounded-md text-sm bg-white/10 hover:bg-white/20 text-white",onClick:()=>navigator.clipboard.writeText(X),type:"button",children:"Copiar link"})]})]}),(0,b.jsxs)("div",{className:"w-[420px] rounded-2xl overflow-hidden shadow-[0_20px_40px_rgba(0,0,0,0.45)]",style:{backgroundColor:J},children:[(0,b.jsxs)("div",{className:"w-full h-[160px] flex flex-col items-center pt-6",style:{background:"linear-gradient(180deg,#5CB0FF 0%,#A3D4FF 100%)"},children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-white rounded-xl flex items-center justify-center overflow-hidden shadow",children:t?(0,b.jsx)("img",{src:t,className:"w-full h-full object-cover",alt:"logo",crossOrigin:"anonymous",onError:()=>console.log("❌ NO carga IMG:",t)}):(0,b.jsx)("span",{className:"text-lg font-bold text-[#142546]",children:"IMG"})}),(0,b.jsx)("h2",{className:"text-lg font-bold text-[#142546] mt-4",children:q})]}),(0,b.jsxs)("div",{className:"mx-4 -mt-4 rounded-xl p-4 text-white shadow-md",style:{backgroundColor:N},children:[(0,b.jsx)("div",{className:"text-xs opacity-90",children:"Monto de Préstamo"}),(0,b.jsx)("input",{type:"text",value:B,onChange:a=>C(a.target.value),placeholder:"$0.00",className:"w-full bg-transparent text-3xl font-bold outline-none",disabled:V})]}),(0,b.jsxs)("div",{className:"px-4 py-5 flex flex-col gap-4",children:[(0,b.jsxs)("div",{className:"bg-transparent rounded-xl border p-3 shadow-sm",style:{backgroundColor:J},children:[(0,b.jsxs)("div",{className:"flex justify-between items-center py-3 border-b",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Producto"}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:q})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center py-3 border-b",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Importe a Pagar"}),(0,b.jsx)("input",{type:"text",value:D,onChange:a=>E(a.target.value),className:"text-gray-400 text-right w-28 bg-transparent font-semibold outline-none",disabled:V})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center py-3 border-b",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Fecha Vencimiento"}),(0,b.jsx)("input",{type:"date",value:F,onChange:a=>G(a.target.value),className:"text-gray-400 text-right bg-transparent outline-none",disabled:V})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center py-3",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Días vencimiento"}),(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:[H," días"]})]})]}),(0,b.jsxs)("div",{className:"bg-transparent rounded-xl p-3 shadow-sm",style:{backgroundColor:J},children:[(0,b.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Elige el método de pago"}),(0,b.jsx)("div",{className:"flex items-center justify-center bg-[#F8FAFB] p-4 rounded-md",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"SPEI"}),(0,b.jsx)("div",{className:"text-lg md:text-xl lg:text-2xl font-extrabold text-gray-700 mt-1",children:r})]})})]}),z&&(0,b.jsxs)("div",{className:"bg-transparent rounded-xl p-3 shadow-sm",style:{backgroundColor:J},children:[(0,b.jsxs)("div",{className:"flex justify-between items-center py-2 border-b",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Nombre"}),(0,b.jsx)("input",{className:"text-sm text-right bg-transparent outline-none text-gray-700",placeholder:"Nombre",value:v,onChange:a=>w(a.target.value),disabled:V})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center py-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Teléfono"}),(0,b.jsx)("input",{className:"text-sm text-right bg-transparent outline-none text-gray-700",placeholder:"Teléfono",value:x,onChange:a=>y(a.target.value),disabled:V})]})]}),(0,b.jsx)("button",{onClick:$,className:"w-full text-white p-3 rounded-xl text-lg font-semibold mt-2 disabled:opacity-60",style:{backgroundColor:N},disabled:V,type:"button",children:V?"Generando link...":"Confirmar y Generar Link"})]})]})]}):(0,b.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-[#152032] text-white p-6",children:["Cargando plantilla ",i?`#${i}`:"","…"]})}a.s(["default",()=>e])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ab0a9b78._.js.map